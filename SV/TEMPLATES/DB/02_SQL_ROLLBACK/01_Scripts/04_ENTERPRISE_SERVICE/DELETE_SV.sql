SET ECHO ON
SET DEFINE OFF
SET SERVEROUTPUT ON
WHENEVER SQLERROR CONTINUE ROLLBACK
------------------------------------------------------------------------------------
-- The following commments can be deleted for each Release
------------------------------------------------------------------------------------
----------------------------------------------------------------
-- V_SERV_CODE @@ ServiceCode
-- V_SERV_NAME @@ ServiceName
-- V_CAP_OP_CODE @@ OperationCode
-- V_CAP_OP_NAME @@ OperationName
----------------------------------------------------------------

DECLARE
	 V_SERV_CODE ESB_SERVICE.CODE%TYPE;
     V_SERV_NAME ESB_SERVICE.NAME%TYPE;
     V_CAP_OP_CODE ESB_CAPABILITY.CODE%TYPE;
     V_CAP_OP_NAME ESB_CAPABILITY.NAME%TYPE;


    PROCEDURE DELETE_CAPABILITY IS
	BEGIN

	-- ESB_PARAMETER ----------------------------------------------------------------------------------------------------------------------------------------
		DELETE ESB_PARAMETER WHERE KEY = 'Logger.error.IsEnabled.'||V_SERV_CODE||'.'||V_SERV_NAME||'.'||V_CAP_OP_NAME;
		DELETE ESB_PARAMETER WHERE KEY = 'Logger.log.IsEnabled.'||V_SERV_CODE||'.'||V_SERV_NAME||'.'||V_CAP_OP_NAME;

	-- ESB_CAPABILITY_CHECK ----------------------------------------------------------------------------------------------------------------------------------------
		DELETE ESB_CAPABILITY_CHECK WHERE CAPABILITY_ID = (SELECT ID FROM ESB_CAPABILITY WHERE CODE = V_CAP_OP_CODE) ;
	
	-- ESB_CAPABILITY ----------------------------------------------------------------------------------------------------------------------------------------
		DELETE ESB_CAPABILITY WHERE CODE = V_CAP_OP_CODE;


	END DELETE_CAPABILITY; 

BEGIN

-- *-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-
-- ======================================================================================================================================================
-- == INCIO DE ZONA A MODIFICAR =========================================================================================================================
-- ======================================================================================================================================================

	V_SERV_CODE :='%SERVICE_CODE%';
 	V_SERV_NAME :='%SERVICE_NAME%';

-- Repetir el bloque por tantas capacidaes se agreguen al servicio.
----------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------  INICIO BLOQUE  ------------------------------------------------------------------------------------------------------------------

%CAPABILITY_QUERY%

--------------------------  FIN BLOQUE -------------------------------------------------------------------------------------------------------------------
--
-- ESB_SERVICE  ------------------------------------------------------------------------------------------------------------------------------------------

	DELETE ESB_SERVICE WHERE CODE = V_SERV_CODE;

-- ======================================================================================================================================================
-- == FIN DE ZONA A MODIFICAR ===========================================================================================================================
-- ======================================================================================================================================================
-- *-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-

END;
/
COMMIT;
